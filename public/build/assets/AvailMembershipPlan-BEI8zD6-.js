import{X as g,r as m,j as e}from"./app-V5G9cFYl.js";import{A as S,a as _,b as y,c as A}from"./Footer-CBVqzZgc.js";import"./Helmet-DTuYPepi.js";const P=()=>{const{all_users:d,get_all_plans:r}=g().props,[t,h]=m.useState(""),[l,p]=m.useState(""),u=async()=>{var o;if(t===""||l===""){alert("Please fill the form before submitting.");return}const s=r.find(a=>a.id==l);if(!s){alert("Selected plan not found.");return}const{duration:i,price:b,plan_name:x,plan_description:j}=s,c=new Date,f=c.toISOString().split("T")[0],n=new Date(c);n.setMonth(n.getMonth()+parseInt(i));const v=n.toISOString().split("T")[0];try{const a=await fetch("/over-the-counter-payment",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":(o=document.querySelector('meta[name="csrf-token"]'))==null?void 0:o.getAttribute("content")},body:JSON.stringify({user_id:t,plan_id:l,plan_duration:i,plan_price:b,plan_name:x,plan_description:j,start_date:f,end_date:v,payment_method:"Over The Counter",status:"Approved"})});if(a.ok)alert("Membership has been successfully availed."),window.location.href="/admin/membership/list-of-members/";else{const N=await a.json();setErrors({general:N.message||"Error submitting!"});return}}catch(a){console.error("Error submitting:",a),setErrors({general:"Something went wrong. Please try again!"});return}};return e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title",children:"Select a member account to join the WellFit Fitness plan."}),e.jsxs("form",{children:[e.jsxs("div",{className:"row mb-3",children:[e.jsx("label",{className:"col-sm-2 col-form-label",children:"Select an Account:"}),e.jsx("div",{className:"col-sm-10",children:e.jsxs("select",{className:"form-select","aria-label":"Default select example",name:"user_id",value:t,onChange:s=>h(s.target.value),children:[e.jsx("option",{children:"Select an Account"}),d.map(s=>e.jsxs("option",{value:s.id,children:[s.first_name," ",s.last_name]},s.id))]})})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("label",{className:"col-sm-2 col-form-label",children:"Select Membership Plan:"}),e.jsx("div",{className:"col-sm-10",children:e.jsxs("select",{className:"form-select","aria-label":"Default select example",name:"plan_id",value:l,onChange:s=>p(s.target.value),children:[e.jsx("option",{children:"Select Membership Plan"}),r.map(s=>e.jsx("option",{value:s.id,children:s.plan_name},s.id))]})})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("label",{className:"col-sm-2 col-form-label"}),e.jsx("div",{className:"col-sm-10",children:e.jsx("button",{type:"submit",className:"btn btn-primary",onClick:s=>{s.preventDefault(),u()},children:"Submit"})})]})]})]})})};function I(){return e.jsxs(e.Fragment,{children:[e.jsx(S,{}),e.jsx(_,{}),e.jsx(y,{}),e.jsxs("main",{id:"main",className:"main",children:[e.jsxs("div",{className:"pagetitle",children:[e.jsx("h1",{children:"Avail Membership Plan"}),e.jsx("nav",{children:e.jsxs("ol",{className:"breadcrumb",children:[e.jsx("li",{className:"breadcrumb-item",children:e.jsx("a",{href:"#",children:"Home"})}),e.jsx("li",{className:"breadcrumb-item active",children:"Avail Membership Plan"})]})})]}),e.jsx("section",{className:"section dashboard",children:e.jsx(P,{})})]}),e.jsx(A,{})]})}export{I as default};
