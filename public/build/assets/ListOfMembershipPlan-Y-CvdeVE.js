import{X as j,r as n,j as e}from"./app-Dq08WHqT.js";import{A as x,a as b,b as N,c as f}from"./Footer-4lxdKpUO.js";import"./Helmet-CeKV6j1M.js";const v=()=>{const{get_all_plans:c,id:y}=j().props,[P,d]=n.useState(null),[o,m]=n.useState(null);n.useState(null);const[a,r]=n.useState({planName:"",description:"",price:"",duration:""}),h=async s=>{var l;if(s.preventDefault(),!o){alert("No plan selected to edit.");return}try{const t=await fetch(`/admin/membership/list-of-membership-plan/edit?id=${o}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":(l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.getAttribute("content")},body:JSON.stringify({plan_name:a.planName,plan_description:a.description,price:a.price,duration:`${a.duration} month${a.duration>1?"s":""}`})}),i=await t.json();console.log(i),t.ok?(alert("Plan updated successfully."),window.location.href="/admin/membership/list-of-membership-plan"):alert("Failed to update plan.")}catch(t){console.error("Update failed:",t)}},p=async s=>{var t;if(window.confirm("Are you sure you want to delete this membership plan?")){d(s);try{const i=await fetch(`/admin/membership/list-of-membership-plan/delete?id=${s}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":(t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content")},body:JSON.stringify({id:s})}),g=await i.json();i.ok&&(alert("Successfully deleted."),window.location.href="/admin/membership/list-of-membership-plan")}catch(i){console.error("Error submitting:",i)}}},u=s=>{m(s);const l=c.find(t=>t.id===s);if(l){const t=l.duration.match(/\d+/),i=t?parseInt(t[0]):"";r({planName:l.plan_name||"",description:l.plan_description||"",price:l.price||"",duration:i})}};return e.jsxs("div",{children:[e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card recent-sales overflow-auto",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title",children:"List Of Membership Plan"}),e.jsxs("table",{className:"table table-borderless datatable",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"Plan Name"}),e.jsx("th",{scope:"col",children:"Duration"}),e.jsx("th",{scope:"col",children:"Price"}),e.jsx("th",{scope:"col",children:"Description"}),e.jsx("th",{scope:"col",children:"Option"})]})}),e.jsx("tbody",{children:c.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.plan_name}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-success",children:s.duration})}),e.jsxs("td",{children:["₱",isNaN(parseInt(s.price))?"N/A":parseInt(s.price).toLocaleString()]}),e.jsx("td",{children:s.plan_description}),e.jsxs("td",{children:[e.jsx("a",{href:"#",onClick:l=>{l.preventDefault(),u(s.id)},children:"Edit"}),"|",e.jsx("a",{href:"#",onClick:l=>{l.preventDefault(),p(s.id)},children:"Delete"})]})]},s.id))})]})]})})}),e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card recent-sales overflow-auto",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title",children:"Edit Plan"}),e.jsxs("form",{onSubmit:h,children:[e.jsxs("div",{className:"row mb-3",children:[e.jsx("label",{htmlFor:"planName",className:"col-sm-2 col-form-label",children:"Plan Name"}),e.jsx("div",{className:"col-sm-10",children:e.jsx("input",{type:"text",id:"planName",name:"planName",className:"form-control",value:a.planName,onChange:s=>r({...a,planName:s.target.value})})})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("label",{htmlFor:"description",className:"col-sm-2 col-form-label",children:"Description"}),e.jsx("div",{className:"col-sm-10",children:e.jsx("textarea",{id:"description",name:"description",className:"form-control",value:a.description,onChange:s=>r({...a,description:s.target.value})})})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("label",{htmlFor:"price",className:"col-sm-2 col-form-label",children:"Price (₱)"}),e.jsx("div",{className:"col-sm-10",children:e.jsx("input",{type:"number",id:"price",name:"price",className:"form-control",value:a.price,onChange:s=>r({...a,price:s.target.value})})})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("label",{htmlFor:"duration",className:"col-sm-2 col-form-label",children:"Duration (Months)"}),e.jsx("div",{className:"col-sm-10",children:e.jsx("input",{type:"number",id:"duration",name:"duration",className:"form-control",value:a.duration,onChange:s=>r({...a,duration:s.target.value})})})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("label",{className:"col-sm-2 col-form-label"}),e.jsx("div",{className:"col-sm-10",children:e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Submit"})})]})]})]})})})]})};function E(){return e.jsxs(e.Fragment,{children:[e.jsx(x,{}),e.jsx(b,{}),e.jsx(N,{}),e.jsxs("main",{id:"main",className:"main",children:[e.jsxs("div",{className:"pagetitle",children:[e.jsx("h1",{children:"List Of Membership Plan"}),e.jsx("nav",{children:e.jsxs("ol",{className:"breadcrumb",children:[e.jsx("li",{className:"breadcrumb-item",children:e.jsx("a",{href:"#",children:"Home"})}),e.jsx("li",{className:"breadcrumb-item active",children:"List Of Membership Plan"})]})})]}),e.jsx("section",{className:"section dashboard",children:e.jsx(v,{})})]}),e.jsx(f,{})]})}export{E as default};
